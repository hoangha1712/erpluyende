<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luyende.ai - ƒê∆∞·ªùng ƒêua Sƒ© T·ª≠</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-blue: #2563EB;
            --action-orange: #F97316; /* Tone cam ch·ªß ƒë·∫°o */
            --bg-light: #F9FAFB;
            --text-dark: #111827;
            --text-gray: #6B7280;
            --white: #FFFFFF;
            --border: #E5E7EB;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg-light); color: var(--text-dark); padding-bottom: 80px; -webkit-font-smoothing: antialiased; }

        /* --- HEADER --- */
        header {
            background-color: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 12px 20px;
            position: sticky; top: 0; z-index: 50;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo-container img { height: 36px; border-radius: 6px; } 
        .user-info { display: flex; align-items: center; gap: 12px; }
        .points-badge { 
            background: #FFF7ED; color: var(--action-orange); 
            padding: 4px 10px; border-radius: 20px; 
            font-size: 13px; font-weight: 700; border: 1px solid #FFEDD5;
        }
        .avatar { 
            width: 36px; height: 36px; background: #EFF6FF; 
            border-radius: 50%; color: var(--primary-blue); 
            display: flex; align-items: center; justify-content: center; font-size: 14px;
        }

        /* --- HERO SECTION --- */
        .hero {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1D4ED8 100%);
            color: white; padding: 30px 20px 50px 20px;
            text-align: center; border-radius: 0 0 24px 24px; margin-bottom: -30px;
        }
        .hero h1 { font-size: 20px; font-weight: 700; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
        .hero p { font-size: 13px; opacity: 0.9; font-weight: 400; }

        /* --- TASK BOARD --- */
        .container { max-width: 500px; margin: 0 auto; padding: 0 16px; position: relative; z-index: 10; }
        
        .board-header {
            display: flex; align-items: center; gap: 8px;
            margin-bottom: 16px; padding-left: 4px;
        }
        .board-header h2 { font-size: 16px; font-weight: 700; color: var(--text-dark); }
        .board-header i { color: var(--action-orange); }

        .task-list { display: flex; flex-direction: column; gap: 12px; position: relative; transition: all 0.3s ease; }

        /* TASK CARD STYLES */
        .task-card {
            background: var(--white); border-radius: 16px; padding: 16px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            transition: transform 0.2s;
        }
        .task-card:active { transform: scale(0.98); }

        .task-left { display: flex; align-items: center; gap: 14px; }
        .task-icon {
            width: 44px; height: 44px; border-radius: 12px;
            background: #F3F4F6; color: var(--text-gray);
            display: flex; align-items: center; justify-content: center; font-size: 18px;
            flex-shrink: 0;
        }
        .task-info h3 { font-size: 14px; font-weight: 600; color: var(--text-dark); margin-bottom: 2px; }
        .task-info p { font-size: 12px; color: var(--text-gray); }

        .btn-action {
            padding: 8px 14px; border-radius: 20px; border: none;
            font-size: 12px; font-weight: 600; cursor: pointer;
            background: #F3F4F6; color: var(--text-gray); white-space: nowrap;
        }

        /* ACTIVE MISSION (NHI·ªÜM V·ª§ M·ªíI) */
        .task-card.mission-0 {
            border: 2px solid var(--action-orange);
            background: #FFF7ED;
        }
        .task-card.mission-0 .task-icon { background: white; color: var(--action-orange); }
        .task-card.mission-0 .btn-action {
            background: var(--action-orange); color: white;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.25);
            animation: pulse 2s infinite;
        }

        /* LOCKED STATE */
        .locked-mode .task-card:not(.mission-0) {
            filter: grayscale(100%); opacity: 0.5; pointer-events: none;
        }
        
        .lock-message {
            position: absolute; top: 90px; left: 0; right: 0; bottom: 0;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 20; pointer-events: none;
        }
        .locked-mode .lock-message { display: flex; }
        .lock-badge {
            background: rgba(31, 41, 55, 0.85); color: white;
            padding: 8px 16px; border-radius: 30px; font-size: 12px; font-weight: 600;
            backdrop-filter: blur(4px); display: flex; align-items: center; gap: 6px;
        }

        /* --- MODAL & POPUP --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);
            z-index: 1000; display: none; opacity: 0;
            transition: opacity 0.3s ease;
            align-items: center; justify-content: center;
        }
        .modal-overlay.show { display: flex; opacity: 1; }

        .modal-box {
            background: white; width: 90%; max-width: 420px;
            border-radius: 20px; padding: 24px; position: relative;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            transform: translateY(20px); transition: transform 0.3s ease;
        }
        .modal-overlay.show .modal-box { transform: translateY(0); }

        /* CLOSE BUTTON (X) */
        .close-btn {
            position: absolute; top: 16px; right: 16px;
            width: 32px; height: 32px; border-radius: 50%;
            background: #F3F4F6; color: #9CA3AF;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.2s; font-size: 16px;
        }
        .close-btn:hover { background: #E5E7EB; color: #4B5563; }

        /* QUIZ UI */
        .progress-container { width: 100%; height: 6px; background: #F3F4F6; border-radius: 10px; margin: 10px 0 24px 0; overflow: hidden;}
        .progress-bar { height: 100%; background: var(--action-orange); width: 33%; transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1); }

        .question-text { font-size: 18px; font-weight: 700; color: var(--text-dark); margin-bottom: 20px; line-height: 1.4; }
        
        .option-item {
            border: 2px solid #E5E7EB; border-radius: 12px; padding: 14px;
            margin-bottom: 12px; cursor: pointer; transition: all 0.2s;
            display: flex; align-items: flex-start; gap: 12px;
        }
        .option-item:hover { border-color: #FDBA74; background: #FFF7ED; }
        .radio-circle {
            width: 20px; height: 20px; border: 2px solid #D1D5DB; border-radius: 50%;
            margin-top: 2px; flex-shrink: 0; position: relative;
        }
        .option-item:hover .radio-circle { border-color: var(--action-orange); }
        .option-text { font-size: 14px; color: #4B5563; line-height: 1.4; }

        /* TOAST NOTIFICATION */
        .toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
            background: #374151; color: white; padding: 12px 24px; border-radius: 30px;
            font-size: 13px; font-weight: 500; z-index: 2000; opacity: 0; transition: all 0.4s;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); display: flex; align-items: center; gap: 8px;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(249, 115, 22, 0); } 100% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0); } }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <div class="logo-container">
            <img src="https://via.placeholder.com/120x40/2563EB/FFFFFF?text=Luyende+AI" alt="Logo">
        </div>
        <div class="user-info">
            <div class="points-badge">‚ö° 0</div>
            <div class="avatar"><i class="fa-solid fa-user"></i></div>
        </div>
    </header>

    <!-- HERO -->
    <section class="hero">
        <h1>ƒê∆∞·ªùng ƒêua Sƒ© T·ª≠</h1>
        <p>Th·ª≠ th√°ch b·∫£n lƒ©nh - Chinh ph·ª•c 9+</p>
    </section>

    <!-- MAIN CONTAINER -->
    <div class="container">
        <div class="board-header">
            <i class="fa-solid fa-layer-group"></i>
            <h2>Nhi·ªám v·ª• tu·∫ßn n√†y</h2>
        </div>

        <!-- DANH S√ÅCH NHI·ªÜM V·ª§ -->
        <div id="taskBoard" class="task-list locked-mode">
            
            <!-- NHI·ªÜM V·ª§ M·ªíI (TRIGGER) -->
            <div class="task-card mission-0" id="triggerCard">
                <div class="task-left">
                    <div class="task-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                    <div class="task-info">
                        <h3>K√≠ch ho·∫°t Tr·ª£ l√Ω AI</h3>
                        <p>Setup l·ªô tr√¨nh ri√™ng & nh·∫≠n 50‚ö°</p>
                    </div>
                </div>
                <button class="btn-action" onclick="startSurvey()">K√≠ch ho·∫°t</button>
            </div>

            <!-- OVERLAY KHI B·ªä KH√ìA -->
            <div class="lock-message">
                <div class="lock-badge"><i class="fa-solid fa-lock"></i> Ho√†n th√†nh k√≠ch ho·∫°t ƒë·ªÉ m·ªü kh√≥a</div>
            </div>

            <!-- C√ÅC NHI·ªÜM V·ª§ KH√ÅC (S·∫º RENDER L·∫†I B·∫∞NG JS) -->
            <div class="task-card">
                <div class="task-left">
                    <div class="task-icon"><i class="fa-regular fa-calendar-check"></i></div>
                    <div class="task-info">
                        <h3>ƒêi·ªÉm danh</h3>
                        <p>Nh·∫≠n ƒëi·ªÉm chuy√™n c·∫ßn</p>
                    </div>
                </div>
                <button class="btn-action">Th·ª±c hi·ªán</button>
            </div>
             <div class="task-card">
                <div class="task-left">
                    <div class="task-icon"><i class="fa-solid fa-share-nodes"></i></div>
                    <div class="task-info">
                        <h3>Chia s·∫ª Facebook</h3>
                        <p>Nh·∫≠n 100 ƒëi·ªÉm</p>
                    </div>
                </div>
                <button class="btn-action">Th·ª±c hi·ªán</button>
            </div>
        </div>
    </div>

    <!-- 1. POPUP KH·∫¢O S√ÅT -->
    <div id="surveyModal" class="modal-overlay">
        <div class="modal-box">
            <!-- N√öT X ƒê√ìNG -->
            <div class="close-btn" onclick="closeSurveyByX()"><i class="fa-solid fa-xmark"></i></div>
            
            <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
            
            <div id="quizContent">
                <!-- JS Render c√¢u h·ªèi v√†o ƒë√¢y -->
            </div>
        </div>
    </div>

    <!-- 2. POPUP K·∫æT QU·∫¢ (CH√öC M·ª™NG) -->
    <div id="successModal" class="modal-overlay">
        <div class="modal-box" style="text-align: center; padding-top: 40px;">
            <div style="font-size: 60px; margin-bottom: 10px;">üéâ</div>
            <h2 style="color: var(--action-orange); margin-bottom: 8px;">K√≠ch ho·∫°t th√†nh c√¥ng!</h2>
            <p id="successMsg" style="color: #4B5563; font-size: 14px; margin-bottom: 24px; line-height: 1.5;">
                AI ƒë√£ thi·∫øt l·∫≠p ch·∫ø ƒë·ªô ph√π h·ª£p.
            </p>
            <div style="background: #F3F4F6; border-radius: 12px; padding: 12px; margin-bottom: 24px; text-align: left; display: flex; align-items: center; gap: 12px;">
                <i class="fa-solid fa-shield-halved" style="color: var(--primary-blue); font-size: 20px;"></i>
                <div>
                    <div style="font-size: 11px; color: #6B7280; text-transform: uppercase; font-weight: 700;">Ch·∫ø ƒë·ªô ƒë√£ b·∫≠t</div>
                    <div style="font-weight: 700; color: var(--text-dark);" id="segmentLabel">...</div>
                </div>
            </div>
            <button class="btn-action" style="background: var(--primary-blue); color: white; width: 100%; padding: 14px; font-size: 14px;" onclick="finalizeUnlock()">
                Kh√°m ph√° nhi·ªám v·ª• ngay
            </button>
        </div>
    </div>

    <!-- TOAST TH√îNG B√ÅO -->
    <div id="toast" class="toast">
        <i class="fa-solid fa-circle-info"></i>
        <span id="toastMsg">Th√¥ng b√°o h·ªá th·ªëng</span>
    </div>

    <script>
        /* --- CONFIG DATA --- */
        const questions = [
            {
                text: "G·∫∑p m·ªôt b√†i To√°n 'si√™u khoai', ph·∫£n x·∫° ƒë·∫ßu ti√™n c·ªßa b·∫°n l√†?",
                options: [
                    { label: "A. T·ª± l·ª±c c√°nh sinh: Tra Google, xem s√°ch, t·ª± m√≤ m·ªõi 'ƒë√£'.", score: 0 },
                    { label: "B. C·∫ßu c·ª©u: Ch·ª•p ·∫£nh h·ªèi b·∫°n b√®/th·∫ßy c√¥ ngay cho nhanh.", score: 1 }
                ]
            },
            {
                text: "Kh√¥ng gian 'tu luy·ªán' l√Ω t∆∞·ªüng gi√∫p b·∫°n t·∫≠p trung 100%?",
                options: [
                    { label: "A. ·∫®n danh: Y√™n tƒ©nh tuy·ªát ƒë·ªëi, kh√¥ng ai l√†m phi·ªÅn.", score: 0 },
                    { label: "B. S√¥i ƒë·ªông: Ph·∫£i th·∫•y b·∫°n b√® online, c√≥ BXH nh·∫£y s·ªë m·ªõi vui.", score: 1 }
                ]
            },
            {
                text: "T∆∞·ªüng t∆∞·ª£ng v·ª´a ƒë·∫°t 9.5 ƒëi·ªÉm To√°n. C·∫£m x√∫c l√∫c ƒë√≥?",
                options: [
                    { label: "A. Vui th·∫ßm: L∆∞u l·∫°i ƒë·ªÉ t·ª± so s√°nh v·ªõi ch√≠nh m√¨nh.", score: 0 },
                    { label: "B. Ph·∫•n kh√≠ch: Ch·ª•p m√†n h√¨nh khoe Story/B·∫°n b√® ngay!", score: 1 }
                ]
            }
        ];

        // DATABASE NHI·ªÜM V·ª§ THEO SEGMENT
        const taskDatabase = {
            introvert: [ // H∆∞·ªõng n·ªôi / Default (Click X)
                { title: "ƒêi·ªÉm danh h√†ng ng√†y", icon: "fa-calendar-check", sub: "Priority High", btn: "ƒêi·ªÉm danh", hot: true },
                { title: "Mini-Quiz Kh·ªüi ƒë·ªông", icon: "fa-book-open", sub: "L√†m 5 c√¢u d·ªÖ", btn: "L√†m ngay", hot: false },
                { title: "Ho√†n th√†nh Profile", icon: "fa-pen-to-square", sub: "C·∫≠p nh·∫≠t tr∆∞·ªùng/l·ªõp", btn: "C·∫≠p nh·∫≠t", hot: false }
            ],
            extrovert: [ // H∆∞·ªõng ngo·∫°i
                { title: "M·ªùi b·∫°n b√® c√πng h·ªçc", icon: "fa-user-plus", sub: "X2 ƒêi·ªÉm th∆∞·ªüng", btn: "M·ªùi ngay", hot: true },
                { title: "Chia s·∫ª K·∫øt qu·∫£", icon: "fa-share-nodes", sub: "Nh·∫≠n 100 ƒëi·ªÉm", btn: "Chia s·∫ª", hot: false },
                { title: "Th√°ch ƒë·∫•u 1vs1", icon: "fa-fire", sub: "ƒêua top th·ªùi gian th·ª±c", btn: "Chi·∫øn ngay", hot: true },
                { title: "ƒêi·ªÉm danh h√†ng ng√†y", icon: "fa-calendar-check", sub: "+20 ƒëi·ªÉm", btn: "ƒêi·ªÉm danh", hot: false }
            ]
        };

        /* --- LOGIC APP --- */
        let currentStep = 0;
        let totalScore = 0;
        let finalSegment = 'introvert'; // Default

        const modal = document.getElementById('surveyModal');
        const successModal = document.getElementById('successModal');
        const board = document.getElementById('taskBoard');

        // 1. M·ªü Quiz
        function startSurvey() {
            currentStep = 0;
            totalScore = 0;
            renderQuestion();
            modal.classList.add('show');
        }

        // 2. Render t·ª´ng c√¢u h·ªèi
        function renderQuestion() {
            const q = questions[currentStep];
            // Update Progress Bar
            document.getElementById('progressBar').style.width = `${((currentStep + 1) / questions.length) * 100}%`;
            
            let html = `<div class="question-text">${currentStep + 1}. ${q.text}</div>`;
            
            q.options.forEach(opt => {
                html += `
                <div class="option-item" onclick="chooseAnswer(${opt.score})">
                    <div class="radio-circle"></div>
                    <div class="option-text">${opt.label}</div>
                </div>`;
            });
            
            document.getElementById('quizContent').innerHTML = html;
        }

        // 3. Ch·ªçn ƒë√°p √°n -> Next
        function chooseAnswer(score) {
            totalScore += score;
            if (currentStep < questions.length - 1) {
                currentStep++;
                // Hi·ªáu ·ª©ng chuy·ªÉn nh·∫π
                const content = document.getElementById('quizContent');
                content.style.opacity = 0;
                setTimeout(() => {
                    renderQuestion();
                    content.style.opacity = 1;
                }, 200);
            } else {
                finishSurvey(false); // false = Normal finish
            }
        }

        // 4. LOGIC QUAN TR·ªåNG: ƒê√ìNG N√öT X (ABANDON)
        function closeSurveyByX() {
            // Insight: User b·∫•m X -> Auto H∆∞·ªõng n·ªôi / Default
            modal.classList.remove('show');
            
            // Show Toast th√¥ng b√°o nh·∫π
            showToast("ƒê√£ √°p d·ª•ng ch·∫ø ƒë·ªô M·∫∑c ƒë·ªãnh (Ri√™ng t∆∞)");
            
            // Unlock board th·∫ßm l·∫∑ng (Kh√¥ng hi·ªán Popup ch√∫c m·ª´ng)
            finalSegment = 'introvert'; 
            renderUnlockedBoard(finalSegment);
        }

        // 5. Ho√†n th√†nh Quiz b√¨nh th∆∞·ªùng
        function finishSurvey() {
            modal.classList.remove('show');
            
            // Logic ph√¢n lo·∫°i: 0-1 = Introvert, 2-3 = Extrovert
            finalSegment = (totalScore >= 2) ? 'extrovert' : 'introvert';
            
            // Setup n·ªôi dung Popup ch√∫c m·ª´ng
            const title = (finalSegment === 'extrovert') ? 'CHI·∫æN TH·∫¶N NGO·∫†I GIAO' : 'CHI·∫æN BINH TH·∫¶M L·∫∂NG';
            const msg = (finalSegment === 'extrovert') 
                ? "H·ªá th·ªëng ƒë√£ m·ªü kh√≥a ƒê·∫•u tr∆∞·ªùng v√† t√≠nh nƒÉng Th√°ch ƒë·∫•u cho b·∫°n!" 
                : "H·ªá th·ªëng ƒë√£ t·ªëi ∆∞u giao di·ªán y√™n tƒ©nh v√† l·ªô tr√¨nh c√° nh√¢n h√≥a cho b·∫°n.";
            
            document.getElementById('segmentLabel').innerText = title;
            document.getElementById('successMsg').innerText = msg;
            
            // Hi·ªán Popup ch√∫c m·ª´ng
            successModal.classList.add('show');
        }

        // 6. Finalize Unlock (T·ª´ Popup ch√∫c m·ª´ng)
        function finalizeUnlock() {
            successModal.classList.remove('show');
            renderUnlockedBoard(finalSegment);
        }

        // 7. Render l·∫°i Board sau khi Unlock
        function renderUnlockedBoard(segment) {
            board.classList.remove('locked-mode');
            
            // X√≥a Card Trigger (Nhi·ªám v·ª• m·ªìi)
            const triggerCard = document.getElementById('triggerCard');
            if(triggerCard) triggerCard.remove();

            // Render tasks
            const tasks = taskDatabase[segment];
            let html = '';
            
            tasks.forEach((t, index) => {
                let badge = t.hot ? `<span style="background:#FEF3C7; color:#D97706; padding:2px 6px; border-radius:4px; font-size:10px; border:1px solid #FCD34D; margin-left:6px;">HOT</span>` : '';
                let btnStyle = t.hot ? `background: var(--action-orange); color: white;` : `background: #F3F4F6; color: var(--text-gray);`;
                
                html += `
                <div class="task-card" style="animation: slideUp 0.4s ease forwards; animation-delay: ${index * 0.1}s; opacity: 0; transform: translateY(10px);">
                    <div class="task-left">
                        <div class="task-icon"><i class="fa-solid ${t.icon}"></i></div>
                        <div class="task-info">
                            <h3>${t.title} ${badge}</h3>
                            <p>${t.sub}</p>
                        </div>
                    </div>
                    <button class="btn-action" style="${btnStyle}">${t.btn}</button>
                </div>`;
            });

            // Append v√†o board (gi·ªØ l·∫°i c√°c task c≈© ho·∫∑c thay th·∫ø ho√†n to√†n - ·ªü ƒë√¢y thay th·∫ø cho demo)
            // Trong th·ª±c t·∫ø b·∫°n c√≥ th·ªÉ merge v·ªõi list c≈©.
            board.innerHTML = html;
            
            // CSS Animation Keyframe
            const style = document.createElement('style');
            style.innerHTML = `@keyframes slideUp { to { opacity: 1; transform: translateY(0); } }`;
            document.head.appendChild(style);
        }

        // Utils: Show Toast
        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = msg;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

    </script>
</body>
</html>