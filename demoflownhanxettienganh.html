<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tutor Feedback Flow Demo</title>
    <!-- Font Awesome & Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        
        /* Mobile Simulator */
        .mobile-frame {
            width: 320px;
            height: 600px;
            border: 12px solid #1f2937;
            border-radius: 30px;
            overflow: hidden;
            background: #fff;
            position: relative;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .notch {
            position: absolute;
            top: 0; left: 50%; transform: translateX(-50%);
            width: 120px; height: 20px;
            background: #1f2937;
            border-bottom-left-radius: 12px;
            border-bottom-right-radius: 12px;
            z-index: 10;
        }

        .checkbox-card {
            transition: all 0.2s;
        }
        .checkbox-card:hover {
            background-color: #f0f9ff;
            border-color: #bae6fd;
        }
        .checkbox-card input:checked + div {
            color: #0284c7;
            font-weight: 600;
        }
        
        /* Tab Active State */
        .tab-btn.active {
            border-bottom: 2px solid #2563eb;
            color: #2563eb;
            font-weight: 600;
        }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- SIDEBAR: STUDENT LIST -->
    <div class="w-full md:w-64 bg-white border-r flex-shrink-0 flex flex-col z-20">
        <div class="p-4 border-b bg-gray-50">
            <h2 class="font-bold text-gray-700"><i class="fas fa-users text-blue-600 mr-2"></i>Danh s√°ch l·ªõp</h2>
            <div class="text-xs text-gray-500 mt-1">Class: ENG-KIDS-01</div>
        </div>
        <div class="flex-1 overflow-y-auto">
            <!-- Student 1: Grade 2 -->
            <div onclick="selectStudent(1)" id="student-1" class="p-3 border-b cursor-pointer hover:bg-blue-50 bg-blue-50 border-l-4 border-l-blue-600 transition">
                <div class="font-semibold text-gray-800">B√© Nana (7 tu·ªïi)</div>
                <div class="text-xs text-gray-500">L·ªõp 2 ‚Ä¢ Level: Starters</div>
            </div>
            <!-- Student 2: Grade 11 -->
            <div onclick="selectStudent(2)" id="student-2" class="p-3 border-b cursor-pointer hover:bg-blue-50 border-l-4 border-l-transparent transition">
                <div class="font-semibold text-gray-800">Nguy·ªÖn VƒÉn Minh</div>
                <div class="text-xs text-gray-500">L·ªõp 11 ‚Ä¢ Level: IELTS 5.0</div>
            </div>
        </div>
    </div>

    <!-- MAIN AREA: INPUT & REVIEW -->
    <div class="flex-1 flex flex-col h-full overflow-hidden relative">
        
        <!-- TOP BAR: BATCH METADATA -->
        <div class="bg-white border-b p-4 shadow-sm z-10">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-sm font-bold text-gray-700 uppercase tracking-wide"><i class="fas fa-layer-group text-blue-500 mr-2"></i>Th√¥ng tin b√†i h·ªçc (Nh·∫≠p 1 l·∫ßn)</h3>
                <label class="flex items-center space-x-2 text-xs cursor-pointer bg-blue-100 text-blue-700 px-3 py-1 rounded-full hover:bg-blue-200 transition">
                    <input type="checkbox" checked class="form-checkbox h-3 w-3 text-blue-600 rounded">
                    <span class="font-semibold">√Åp d·ª•ng cho c·∫£ l·ªõp</span>
                </label>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="col-span-1">
                    <label class="text-xs text-gray-500 font-semibold">Unit Name (Auto)</label>
                    <input type="text" value="Unit 5: Amazing Animals" disabled class="w-full bg-gray-100 border rounded px-2 py-1.5 text-sm font-medium text-gray-700">
                </div>
                <div class="col-span-2">
                    <label class="text-xs text-gray-500 font-semibold">N·ªôi dung tr·ªçng t√¢m (Vocab/Grammar)</label>
                    <input type="text" id="lesson-content" value="Vocab: wild animals. Grammar: Present Continuous (is sleeping, is running)" class="w-full border border-gray-300 rounded px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>
        </div>

        <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <!-- INPUT FORM (Scrollable) -->
            <div class="flex-1 overflow-y-auto p-6 pb-24">
                
                <!-- TABS -->
                <div class="flex border-b mb-6">
                    <button onclick="switchTab('feedback')" id="tab-feedback" class="tab-btn active px-4 py-2 text-sm">Nh·∫≠n x√©t Ph·ª• huynh</button>
                    <button onclick="switchTab('internal')" id="tab-internal" class="tab-btn px-4 py-2 text-sm text-gray-500 hover:text-gray-700">üîí Ghi ch√∫ N·ªôi b·ªô</button>
                </div>

                <!-- TAB CONTENT: FEEDBACK -->
                <div id="content-feedback" class="space-y-6">
                    <!-- 1. Attitude -->
                    <div class="bg-white rounded-lg shadow-sm border p-4">
                        <h4 class="font-bold text-gray-700 mb-3 text-sm flex items-center"><i class="far fa-smile text-yellow-500 mr-2"></i>Th√°i ƒë·ªô h·ªçc t·∫≠p (Attitude)</h4>
                        <div class="grid grid-cols-2 gap-3">
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="att-1" class="mr-2 accent-blue-600"> <div>H√†o h·ª©ng, xung phong</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="att-2" class="mr-2 accent-blue-600"> <div>T·∫≠p trung t·ªët</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="att-3" class="mr-2 accent-red-500"> <div>M·∫•t t·∫≠p trung / N√≥i chuy·ªán</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="att-4" class="mr-2 accent-red-500"> <div>U·ªÉ o·∫£i / Bu·ªìn ng·ªß</div>
                            </label>
                        </div>
                    </div>

                    <!-- 2. Skills -->
                    <div class="bg-white rounded-lg shadow-sm border p-4">
                        <h4 class="font-bold text-gray-700 mb-3 text-sm flex items-center"><i class="fas fa-bolt text-blue-500 mr-2"></i>K·ªπ nƒÉng & Ki·∫øn th·ª©c (Minh ch·ª©ng)</h4>
                        <div class="grid grid-cols-1 gap-3">
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="skill-1" class="mr-2 accent-green-600"> <div>Ph√°t √¢m t·ª´ v·ª±ng to, r√µ r√†ng</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="skill-2" class="mr-2 accent-red-500"> <div>Qu√™n "Ending sounds" (s, t, k)</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="skill-3" class="mr-2 accent-green-600"> <div>N·∫Øm ch·∫Øc ng·ªØ ph√°p b√†i h·ªçc</div>
                            </label>
                            <label class="checkbox-card flex items-center p-2 border rounded cursor-pointer">
                                <input type="checkbox" id="skill-4" class="mr-2 accent-red-500"> <div>Sai c·∫•u tr√∫c ng·ªØ ph√°p (qu√™n to be/verb-ing)</div>
                            </label>
                        </div>
                    </div>

                    <!-- 3. Homework -->
                    <div class="bg-white rounded-lg shadow-sm border p-4">
                        <h4 class="font-bold text-gray-700 mb-3 text-sm flex items-center"><i class="fas fa-book text-indigo-500 mr-2"></i>BTVN (Homework)</h4>
                        <div class="flex gap-4">
                            <label class="flex items-center cursor-pointer"><input type="radio" name="hw" value="full" class="mr-2"> Ho√†n th√†nh t·ªët</label>
                            <label class="flex items-center cursor-pointer"><input type="radio" name="hw" value="missing" class="mr-2"> Thi·∫øu b√†i</label>
                            <label class="flex items-center cursor-pointer"><input type="radio" name="hw" value="none" class="mr-2"> Ch∆∞a l√†m</label>
                        </div>
                    </div>
                </div>

                <!-- TAB CONTENT: INTERNAL -->
                <div id="content-internal" class="hidden">
                    <div class="bg-yellow-50 border border-yellow-200 text-yellow-800 p-3 rounded mb-4 text-xs">
                        <i class="fas fa-lock mr-1"></i> Th√¥ng tin n√†y ch·ªâ l∆∞u h√†nh n·ªôi b·ªô, kh√¥ng g·ª≠i cho Ph·ª• huynh.
                    </div>
                    <textarea class="w-full border p-3 rounded text-sm h-32" placeholder="Ghi ch√∫ s·ª± c·ªë, h√†nh vi, ƒë·ªÅ xu·∫•t CSKH..."></textarea>
                </div>
            </div>

            <!-- ACTION FOOTER -->
            <div class="absolute bottom-0 left-0 w-full md:w-auto md:right-[340px] bg-white border-t p-4 z-20 flex justify-between items-center shadow-lg">
                <div class="text-xs text-gray-500 italic hidden md:block">
                    * AI s·∫Ω t·ª± ƒë·ªông ch·ªçn tone gi·ªçng theo tu·ªïi h·ªçc sinh
                </div>
                <button onclick="generateFeedback()" class="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-6 py-2.5 rounded-lg font-bold shadow-md transition transform hover:-translate-y-0.5 flex items-center">
                    <i class="fas fa-magic mr-2"></i> T·∫°o Nh·∫≠n X√©t (AI)
                </button>
            </div>

            <!-- RIGHT PANEL: PREVIEW & REVIEW (DESKTOP MODE) -->
            <div class="w-full md:w-[400px] bg-gray-100 border-l flex flex-col h-full border-t md:border-t-0">
                
                <!-- TEACHER REVIEW BOX -->
                <div class="flex-1 flex flex-col p-4 overflow-hidden">
                    <h3 class="font-bold text-gray-700 mb-2 flex justify-between items-center">
                        <span><i class="fas fa-edit text-gray-500 mr-2"></i>Gi√°o vi√™n duy·ªát (Review)</span>
                        <span id="word-count" class="text-xs font-normal text-gray-400">0 t·ª´</span>
                    </h3>
                    
                    <!-- EDITABLE AREA -->
                    <div class="flex-1 relative">
                        <textarea id="ai-output" class="w-full h-full p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 text-sm leading-relaxed resize-none font-sans" placeholder="K·∫øt qu·∫£ AI s·∫Ω hi·ªán ·ªü ƒë√¢y ƒë·ªÉ th·∫ßy/c√¥ ch·ªânh s·ª≠a..."></textarea>
                        
                        <!-- AI Actions Overlay -->
                        <div id="ai-loading" class="absolute inset-0 bg-white/80 flex items-center justify-center rounded-lg hidden z-10">
                            <div class="flex flex-col items-center">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-2"></div>
                                <span class="text-xs font-semibold text-blue-600">AI ƒëang vi·∫øt...</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 flex gap-2">
                        <button class="flex-1 bg-white border border-gray-300 text-gray-600 py-2 rounded font-semibold text-xs hover:bg-gray-50">
                            <i class="fas fa-sync-alt mr-1"></i> Vi·∫øt l·∫°i
                        </button>
                        <button onclick="showMobilePreview()" class="flex-1 bg-green-600 text-white py-2 rounded font-semibold text-xs hover:bg-green-700 shadow-sm">
                            <i class="fas fa-paper-plane mr-1"></i> G·ª≠i & Xem App
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: PARENT MOBILE VIEW -->
    <div id="mobile-modal" class="fixed inset-0 bg-black/70 z-50 hidden flex items-center justify-center backdrop-blur-sm">
        <div class="mobile-frame animate-fade-in-up">
            <div class="notch"></div>
            
            <!-- App Header -->
            <div class="bg-blue-600 text-white pt-12 pb-4 px-4 shadow-md">
                <div class="flex justify-between items-center">
                    <i class="fas fa-chevron-left"></i>
                    <span class="font-semibold">B√°o c√°o h·ªçc t·∫≠p</span>
                    <i class="fas fa-bell"></i>
                </div>
            </div>

            <!-- App Content -->
            <div class="h-full bg-gray-50 overflow-y-auto pb-20">
                <div class="p-4">
                    <div class="text-center mb-4">
                        <div class="inline-block p-1 rounded-full bg-white shadow-sm mb-2">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Nana" class="w-16 h-16 rounded-full bg-blue-50" alt="Avatar">
                        </div>
                        <h2 class="font-bold text-gray-800 text-lg" id="mobile-student-name">B√© Nana</h2>
                        <p class="text-xs text-gray-500">12/11/2025 ‚Ä¢ 19:30 - 21:00</p>
                    </div>

                    <!-- THE FEEDBACK CARD -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="border-b px-4 py-3 bg-blue-50 flex justify-between items-center">
                            <span class="font-bold text-blue-800 text-sm">üíå Nh·∫≠n x√©t t·ª´ C√¥ Linh</span>
                        </div>
                        <div class="p-5 text-sm text-gray-700 space-y-4" id="mobile-content">
                            <!-- Content injected via JS -->
                        </div>
                    </div>

                    <!-- Action Button -->
                    <div class="mt-4 flex gap-3">
                        <button class="flex-1 bg-white border py-2.5 rounded-lg text-xs font-semibold text-gray-600 shadow-sm">Ph·∫£n h·ªìi l·∫°i</button>
                        <button class="flex-1 bg-blue-600 text-white py-2.5 rounded-lg text-xs font-semibold shadow-sm shadow-blue-200">X√°c nh·∫≠n ƒë√£ ƒë·ªçc</button>
                    </div>
                </div>
            </div>
            
            <!-- Close Modal Btn -->
            <button onclick="closeMobilePreview()" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-1 rounded-full text-xs opacity-80 hover:opacity-100">
                ƒê√≥ng Demo
            </button>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        let currentStudent = 1; // 1 = Kid, 2 = Teen

        function switchTab(tab) {
            document.getElementById('content-feedback').classList.add('hidden');
            document.getElementById('content-internal').classList.add('hidden');
            document.getElementById('tab-feedback').classList.remove('active');
            document.getElementById('tab-internal').classList.remove('active');

            document.getElementById(`content-${tab}`).classList.remove('hidden');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        function selectStudent(id) {
            currentStudent = id;
            
            // Visual Update Sidebar
            document.getElementById('student-1').className = "p-3 border-b cursor-pointer hover:bg-blue-50 border-l-4 border-l-transparent transition";
            document.getElementById('student-2').className = "p-3 border-b cursor-pointer hover:bg-blue-50 border-l-4 border-l-transparent transition";
            
            const activeClass = "p-3 border-b cursor-pointer hover:bg-blue-50 bg-blue-50 border-l-4 border-l-blue-600 transition";
            document.getElementById(`student-${id}`).className = activeClass;

            // Clear checkboxes to simulate new student
            document.querySelectorAll('input[type="checkbox"]:not(.form-checkbox)').forEach(el => el.checked = false);
            document.getElementById('ai-output').value = "";
            
            // Pre-fill for demo purposes
            if(id === 1) { // Kid
                document.getElementById('att-1').checked = true; // H√†o h·ª©ng
                document.getElementById('skill-1').checked = true; // Ph√°t √¢m t·ªët
                document.getElementById('skill-4').checked = true; // Sai ng·ªØ ph√°p
            } else { // Teen
                document.getElementById('att-2').checked = true; // T·∫≠p trung
                document.getElementById('skill-3').checked = true; // Ng·ªØ ph√°p t·ªët
                document.getElementById('skill-2').checked = true; // Sai ending sound
            }
        }

        function generateFeedback() {
            // Show Loading
            const loader = document.getElementById('ai-loading');
            loader.classList.remove('hidden');

            setTimeout(() => {
                const lesson = document.getElementById('lesson-content').value;
                let text = "";

                // SIMULATING AI LOGIC BASED ON USER STORY ACs
                if (currentStudent === 1) {
                    // TONE: KID (L·ªõp 1-5) - Vui v·∫ª, Emojis
                    text = `üìö B√†i h·ªçc: H√¥m nay con h·ªçc v·ªÅ ${lesson.split(':')[1].split('.')[0]}.\n\n`;
                    text += `üåü ƒêi·ªÉm s√°ng:\n‚Ä¢ Nana h·ªçc si√™u h√†o h·ª©ng! Con xung phong tr·∫£ l·ªùi su·ªët. üéâ\n‚Ä¢ Con ph√°t √¢m c√°c t·ª´ v·ª±ng to v√† r√µ r√†ng l·∫Øm.\n\n`;
                    text += `üõ† C·∫ßn c·∫£i thi·ªán:\n‚Ä¢ Con ch√∫ √Ω ng·ªØ ph√°p "Present Continuous" nh√© (nh·ªõ th√™m 'ing' sau ƒë·ªông t·ª´ nha).\n\n`;
                    text += `üí° D·∫∑n d√≤:\n‚Ä¢ M·∫π cho con xem l·∫°i video b√†i h√°t v·ªÅ ƒë·ªông v·∫≠t 5 ph√∫t nh√©! üí™`;
                } else {
                    // TONE: TEEN (L·ªõp 11) - Chuy√™n nghi·ªáp, Mentor
                    text = `üìö N·ªôi dung: √în t·∫≠p v·ªÅ ${lesson.split(':')[1].split('.')[0]} v√† c·∫•u tr√∫c ng·ªØ ph√°p.\n\n`;
                    text += `‚úÖ ƒêi·ªÉm m·∫°nh:\n‚Ä¢ Minh gi·ªØ v·ªØng s·ª± t·∫≠p trung cao ƒë·ªô trong su·ªët bu·ªïi h·ªçc.\n‚Ä¢ Em n·∫Øm r·∫•t ch·∫Øc c·∫•u tr√∫c th√¨ Hi·ªán t·∫°i ti·∫øp di·ªÖn, l√†m b√†i t·∫≠p ch√≠nh x√°c.\n\n`;
                    text += `üõ† C·∫ßn l∆∞u √Ω:\n‚Ä¢ Em v·∫´n hay qu√™n b·∫≠t √¢m ƒëu√¥i (ending sounds) khi n√≥i nhanh. C·∫ßn ch√∫ √Ω k·ªπ h∆°n.\n\n`;
                    text += `üí° ƒê·ªãnh h∆∞·ªõng:\n‚Ä¢ Em h√£y luy·ªán n√≥i l·∫°i ƒëo·∫°n h·ªôi tho·∫°i trang 15 v√† ghi √¢m ƒë·ªÉ t·ª± ki·ªÉm tra l·ªói ph√°t √¢m nh√©.`;
                }

                document.getElementById('ai-output').value = text;
                loader.classList.add('hidden');
                
                // Update word count
                document.getElementById('word-count').innerText = text.split(' ').length + " t·ª´";
            }, 1500); // Simulate 1.5s API delay
        }

        function showMobilePreview() {
            const content = document.getElementById('ai-output').value;
            if(!content) { alert("Vui l√≤ng t·∫°o nh·∫≠n x√©t tr∆∞·ªõc!"); return; }

            // Format text for HTML display (convert \n to <br>)
            // Also create colorful badges for the sections to look like a real app
            let formattedHtml = content
                .replace(/üìö (.*?):/g, '<div class="font-bold text-gray-800 mb-1">üìö $1:</div>')
                .replace(/üåü (.*?):/g, '<div class="font-bold text-green-600 mt-3 mb-1 bg-green-50 p-1 rounded inline-block">üåü $1:</div>')
                .replace(/‚úÖ (.*?):/g, '<div class="font-bold text-green-600 mt-3 mb-1 bg-green-50 p-1 rounded inline-block">‚úÖ $1:</div>')
                .replace(/üõ† (.*?):/g, '<div class="font-bold text-orange-600 mt-3 mb-1 bg-orange-50 p-1 rounded inline-block">üõ† $1:</div>')
                .replace(/üí° (.*?):/g, '<div class="font-bold text-blue-600 mt-3 mb-1 bg-blue-50 p-1 rounded inline-block">üí° $1:</div>')
                .replace(/\n/g, '<br>');

            document.getElementById('mobile-content').innerHTML = formattedHtml;
            
            // Set Name
            const name = currentStudent === 1 ? "B√© Nana" : "Nguy·ªÖn VƒÉn Minh";
            document.getElementById('mobile-student-name').innerText = name;
            
            document.getElementById('mobile-modal').classList.remove('hidden');
        }

        function closeMobilePreview() {
            document.getElementById('mobile-modal').classList.add('hidden');
        }

        // Init
        selectStudent(1);
    </script>
</body>
</html>